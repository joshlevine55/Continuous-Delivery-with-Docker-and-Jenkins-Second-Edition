pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                sh "./gradlew build"
            }
        }

    stage('Check Java Changes') {
          when {
                  changeset "**/*.java"
          }
          steps {
              sh "./gradlew codecoverage"
              sh "./gradlew checkstyle"
          }
    }
        
    stage('Run all other Tests') {
        steps {
            sh "./gradlew jacocoTestReport"
            sh "./gradlew jacocoTestCoverageVerification"
        }
      }
}
post {
    failure {
        echo 'Pipeline failure'
    }
    success {
        echo 'Pipeline ran perfectly'
    }
}
}
